// Generated by CoffeeScript 1.6.3
(function() {
  'use strict';
  var CtrlUserBoard, SingleResult, app, app_name,
    __slice = [].slice;

  app_name = "myApp";

  app = angular.module("" + app_name + ".controllers", ['ui.bootstrap']);

  app.controller('myCtrl2', [
    '$scope', function($scope) {
      return $scope.test = 'some text';
    }
  ]);

  SingleResult = (function() {
    function SingleResult(_arg) {
      this.day = _arg.day, this.dateTime = _arg.dateTime, this.ticked = _arg.ticked, this.streak = _arg.streak;
    }

    return SingleResult;

  })();

  app.controller('CtrlUserBoard', CtrlUserBoard = (function() {
    var createResults, createSingleResult;

    function CtrlUserBoard($scope, ActiveHabit, Habit) {
      var now, today;
      $scope.daysAgo = 0;
      now = moment();
      today = now.startOf('day');
      $scope.displayedToday = today.valueOf();
      $scope.$watch('today', function() {
        return $scope.displayedToday = today.valueOf();
      });
      $scope.selectedDay = moment(today);
      $scope.displayedDay = $scope.selectedDay.valueOf();
      $scope.$watch('daysAgo', function() {
        $scope.selectedDay = moment($scope.today).add('days', $scope.daysAgo);
        return $scope.displayedDay = $scope.selectedDay.valueOf();
      });
      $scope.allHabits = _.map(['Meditation', 'Exercise', 'Procrastination', 'Get Organized', 'Stay Organized', 'Organize Emails'], function(name) {
        return new Habit(name);
      });
      $scope.myHabits = [new ActiveHabit('Meditation', 0, createResults([1, 'done'])), new ActiveHabit('Exercise', 0, createResults([1, 'failed'], [2, 'failed'], [3, 'done'], [4, 'done'], [5, 'done'], [6, 'done'], [7, 'done'], [8, 'done']))];
      $scope.inputHabitName = void 0;
      $scope.allHabitNames = _.pluck($scope.allHabits, 'name');
      $scope.myHabitNames = _.pluck($scope.myHabits, 'name');
      $scope.otherHabitNames = _.difference($scope.allHabitNames, $scope.myHabitNames);
      $scope.dateChangeIsSelected = 0;
      $scope.thisIsToday = function() {
        return $scope.selectedDay.isSame(today);
      };
      $scope.clickPrevWeek = function() {
        return $scope.daysAgo += 7;
      };
      $scope.clickNextWeek = function() {
        return $scope.daysAgo -= 7;
      };
      $scope.pickedDate = today.format('YYYY-MM-DD');
      $scope.addOneHabit = function(name, pickedDate) {
        var nbDaysToInit;
        if (name === void 0 || name === '') {
          return;
        }
        nbDaysToInit = today.diff(pickedDate, 'days');
        $scope.myHabits.push(new ActiveHabit(name, nbDaysToInit));
        console.log('Habit #{name} added');
        $scope.nowAddingHabit = false;
        return $scope.dateChangeIsSelected = 0;
      };
      $scope.wasActive = function(habit) {
        return habit.wasActive($scope.daysAgo);
      };
    }

    createSingleResult = function(daysAgo, tck) {
      return new SingleResult({
        day: moment().subtract('days', daysAgo).startOf('day'),
        dateTime: moment().subtract('days', daysAgo),
        ticked: tck,
        streak: 0
      });
    };

    createResults = function() {
      var results, resultsArgs;
      resultsArgs = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
      return results = _.map(resultsArgs, function(args) {
        return createSingleResult.apply(null, args);
      });
    };

    return CtrlUserBoard;

  })());

}).call(this);
